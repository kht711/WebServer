<html>
  <head>
    <meta charset="uft-8">
    <script src="./jquery-3.4.1.js"></script>
  </head>
  <body>
    名前で探す<br>
    <input type="text" id="name">
    <hr>
    並び変え<br>
    <table>
      <tr>
          <td>レア度 : </td>
          <td>
              <select id="rare" style="width:150px" onchange="filter()">
                  <option value="*">*</option>
                  <option value="N">N</option>
                  <option value="R">R</option>
                  <option value="HR">HR</option>
                  <option value="SR">SR</option>
              </select>
          </td>
      </tr>
      <tr>
          <td>属性 : </td>
          <td>
              <select id="zokusei" style="width:150px" onchange="filter()">
                  <option value="*">*</option>
                  <option value="依存">依存</option>
                  <option value="執着">執着</option>
                  <option value="束縛">束縛</option>
                  <option value="狂気">狂気</option>
                  <option value="無属">無属</option>
              </select>
          </td>
      </tr>
      <tr>
          <td>性格 : </td>
          <td>
              <select id="seikaku" style="width:150px" onchange="filter()">
                  <option value="*">*</option>
                  <option value="元気">元気</option>
                  <option value="活発">活発</option>
                  <option value="清楚">清楚</option>
                  <option value="癒やし">癒やし</option>
                  <option value="献身">献身</option>
                  <option value="陰湿">陰湿</option>
                  <option value="狡猾">狡猾</option>
                  <option value="乱暴">乱暴</option>
                  <option value="凶暴">凶暴</option>
                  <option value="バカ">バカ</option>
                  <option value="ドジ">ドジ</option>
                  <option value="ツンデレ">ツンデレ</option>
                  <option value="変態">変態</option>
                  <option value="淫乱">淫乱</option>
                  <option value="甘えん坊">甘えん坊</option>
                  <option value="腹黒">腹黒</option>
                  <option value="ぷんぷん">ぷんぷん</option>
                  <option value="すきんしっぱー">すきんしっぱー</option>
                  <option value="抑圧ちゃん">抑圧ちゃん</option>
                  <option value="怪奇">怪奇</option>
                  <option value="逆襲">逆襲</option>
              </select>
          </td>
      </tr>
      <tr>
          <td>スキル範囲 : </td>
          <td>
              <select id="skill_who" style="width:150px" onchange="filter()">
                  <option value="*">*</option>
                  <option value="自">自</option>
                  <option value="全">全</option>
                  <option value="単">単</option>
                  <option value="敵">敵</option>
                  <option value="敵全">敵全</option>
                  <option value=""></option>
              </select>
          </td>
      </tr>
      <tr>
          <td>スキル内容 : </td>
          <td>
              <select id="skill_what" style="width:150px" onchange="filter()">
                  <option value="*">*</option>
                  <option value="攻UP">攻UP</option>
                  <option value="攻DOWN">攻DOWN</option>
                  <option value="防UP">防UP</option>
                  <option value="防DOWN">防DOWN</option>
                  <option value="狂乱">狂乱</option>
                  <option value="狡猾">狡猾</option>
                  <option value="心中">心中</option>
                  <option value="束縛">束縛</option>
                  <option value="感染">感染</option>
                  <option value="監禁">監禁</option>
                  <option value="献身">献身</option>
              </select>
          </td>
      </tr>
      <tr>
          <td>スキル規模 : </td>
          <td>
              <select id="skill_size" style="width:150px" onchange="filter()">
                  <option value="*">*</option>
                  <option value="小">小</option>
                  <option value="中">中</option>
                  <option value="大">大</option>
                  <option value=""></option>
              </select>
          </td>
      </tr>
    </table>
    <hr>
    <table border="1" id="order">
    </table>
  </body>
  <script>
    var listNum = 1;
    $(document).ready(function (){
      $("#order").append("<tr><th>番号</th> <th>リスト順</th> <th>名前</th> <th>レア度</th> <th>属性</th> <th>性格</th> <th>スキル範囲</th> <th>スキル内容</th> <th>スキル規模</th> <th>スキル名</th> <th>カード個数</th> <th>URL移動</th></tr>");
      $.get("./yandemicList.txt", function(data){
        var lines = data.split("\n");
        $.each(lines, function(index, value){
          if (index < lines.length - 1){
            e = value.split(", ");
            $("#order").append("<tr><td>" + e[0] + "</td><td>" + listNum + "</td> <td title='" + e[2] + "'>" + e[1] + "</td> <td>" + e[3] + "</td> <td>" + e[4] + "</td> <td>" + e[5] + "</td> <td>" + e[6] + "</td> <td>" + e[7] + "</td> <td>" + e[8] + "</td> <td>" + e[9] + "</td> <td>" + e[10] + "</td> <td><a href='" + e[11] + "'>移動</a></td></tr>");
            listNum = listNum + Number(e[10]);
          }
        });
      });
    });
  </script>
</html>
<script>
  let selectTable = document.getElementById("order");

  let columnName = ["レア度", "属性", "性格", "スキル範囲", "スキル内容", "スキル規模"];
  let column1 = ["*", "N", "R", "HR", "SR"];
  let column2 = ["*", "依存", "執着", "束縛", "狂気", "無属"];
  let column3 = ["*", "元気", "活発", "清楚", "癒やし", "献身",
  "陰湿", "狡猾", "乱暴", "凶暴", "バカ",
  "ドジ", "ツンデレ", "変態", "淫乱", "甘えん坊",
  "腹黒", "ぷんぷん", "すきんしっぱー", "抑圧ちゃん", "怪奇",
  "逆襲"];
  let column4 = ["*", "自", "全", "単", "敵", "敵全", "N/A"];
  let column5 = ["*", "攻UP", "攻DOWN", "防UP", "防DOWN",
  "狂乱", "狡猾", "心中", "束縛", "感染", "監禁", "献身"];
  let column6 = ["*", "小", "中", "大", "N/A"];
  let columns = [column1, column2, column3, column4, column5, column6];

  for (let i = 0; i < columnName.length; i++){
      let tr = document.createElement("tr");
      selectTable.appendChild(tr);
      for (let j = 0; j < 2; j++){
          let td = document.createElement("td");
          tr.appendChild(td);
          if (j == 0){
              td.innerHTML = columnName[i] + " : ";
          }else{
              td.style.width = "150px";
              let select = document.createElement("select");
              td.appendChild(select);
              select.style.width = "150px";
              select.addEventListener("change", filter);
              for (let op = 0; op < columns[i].length; op++){
                  let option = document.createElement("option");
                  option.text = columns[i][op];
                  select.add(option);
              }
          }
      }
  }
  let hr = document.createElement("hr");
  filterDiv.appendChild(hr);


  function filter(){
      let name = document.getElementById("name").value.trim();
      let selectTable = document.getElementById("selectTable");
      let selects = selectTable.getElementsByTagName("select");

      let tr = table.getElementsByTagName('tr');
      for (let i = 1; i < tr.length; i++){
          tr[i].style.display = '';
      }

      if (name != ""){
          for (let i = 1; i < tr.length; i++){
              let td = tr[i].getElementsByTagName("td");
              if (td[2].innerHTML.indexOf(name) == -1 && td[2].title.indexOf(name) == -1){
                  tr[i].style.display = "none";
              }
          }
      }

      for (let sel = 0; sel < selects.length; sel++){
          let filterValue = selects[sel].value;
          if (filterValue != "*"){
              for (let i = 1; i < tr.length; i++){
                  let td = tr[i].getElementsByTagName("td");
                  if ((sel == 0 || sel == 3) && td[sel + 3].innerHTML != filterValue){
                      tr[i].style.display = "none";
                  }else if (td[sel + 3].innerHTML.indexOf(filterValue) == -1){
                      tr[i].style.display = "none";
                  }
              }
          }
      }
  }
</script>
